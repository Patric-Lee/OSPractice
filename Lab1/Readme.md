# Lab 1 报告

## 虚拟机与容器技术

虚拟机技术，就是使用软件技术对硬件资源、系统配置、体系结构、网络环境等方面加以抽象，
从而达到模拟某个操作系统运行环境的技术。真实的操作系统环境被称为宿主机，而被模拟的操作系统
则被称为Guest OS。Guest OS可以真实地再现被模拟的操作系统，使得用户无需安装新的操作系统就可以在其上运行应用程序，
方便了用户的使用。常见的虚拟机如VM Ware， Virtual Box等。

相比之下，容器一种更加新颖的虚拟化技术。它利用Linux namespace和cgroup机制，将容器与原系统其它部分隔离，同样实现了虚拟化的功能。
典型的容器技术如lxc、lxd，还有在lxc基础上发展起来的docker。

与虚拟机相比，容器有以下几个显著的不同：
其一，宿主机的系统。虚拟机可以在任何系统上运行，Windows，Mac OS， Linux，也可以模拟任何操作系统。但容器由于利用了Linux的namespace及cgroup机制，
只能运行在Linux上，也只能模拟Linux的各个版本。

其二，运行开销和运行速度。虚拟机试图模拟完整的硬件资源、操作系统等，与宿主机是完全隔离的。因此虚拟机运行开销大，速度也慢。而容器由于共享内核，
也无需进行复杂的硬件资源模拟，只提供需要的运行环境及库，减少了冗余，开销小，速度快。

其三，资源的利用方式。通常虚拟机分配所得的资源（如CPU、磁盘空间、内存）是固定的、静态的、一次性分配好的，造成浪费。但容器可以动态地分配资源，从而
更好地进行利用。

其四，安全性。虚拟机由于与宿主机完全隔离，因此安全性要更高一些。

## Docker与LXC
LXC试图提供整个的操作系统，而Docker更面向应用。

## 实验

### 实验环境
Ubuntu 16.04
Python 3.5.4
LXC 1.0

### 实验步骤

首先，参照

> https://linuxcontainers.org/lxc/getting-started/

进行lxc的配置及安装。

利用
> https://linuxcontainers.org/lxc/documentation/#python
中提供的api完成容器的创建、启动、停止和销毁。

实验的关键在于如何在容器内部创建文件并写入字符串。事实上，我在这里尝试了几种方法。
lxc.attach_run_command看上去可以在容器中直接运行命令，但用于写文件的重定向符号“>”在这里似乎失效，因此需要另辟他径。

成功的方法是利用容器的attach_wait方法。该方法接收一个单参数的函数名称作为第一个参数，接收这个函数的参数为第二参数，并实现在
容器内部执行该函数的功能。因此，我定义了echo_string函数，并将要写入的文件名和字符串作为参数传给echo_string，在函数内部完成写入的工作。
当容器attach_wait这个echo_string函数时，就会在容器内部执行该函数了。













